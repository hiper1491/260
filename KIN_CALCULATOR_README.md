# 13月亮曆 Kin 計算器 - 使用說明

## 📋 概述

根據官方講義數據，重新改寫的印記（Kin）計算邏輯，確保準確顯示每日能量。

---

## 🎯 核心計算公式

```
Kin = (年份常數 + 月份常數 + 日期) mod 260
```

若總和超過 260，則減去 260 的倍數，直到數字在 1~260 之間。

---

## 📊 數據常數表

### 月份常數 (Month Constants)

| 月份 | 常數 | 月份 | 常數 |
|------|------|------|------|
| 1月  | 0    | 7月  | 181  |
| 2月  | 31   | 8月  | 212  |
| 3月  | 59   | 9月  | 243  |
| 4月  | 90   | 10月 | 13   |
| 5月  | 120  | 11月 | 44   |
| 6月  | 151  | 12月 | 74   |

### 年份常數 (Year Constants)

| 年份 | 常數 | 年份 | 常數 | 年份 | 常數 | 年份 | 常數 |
|------|------|------|------|------|------|------|------|
| 2014 | 62   | 2020 | 172  | 2026 | 22   | 2032 | 132  |
| 2015 | 167  | 2021 | 17   | 2027 | 127  | 2033 | 237  |
| 2016 | 12   | 2022 | 122  | 2028 | 232  | 2034 | 82   |
| 2017 | 117  | 2023 | 227  | 2029 | 77   | 2035 | 187  |
| 2018 | 222  | 2024 | 72   | 2030 | 182  |      |      |
| 2019 | 67   | 2025 | 177  | 2031 | 27   |      |      |

---

## ⚠️ 閏年特殊規則

### 規則 1：2月29日
- **條件**：日期為 2 月 29 日
- **處理**：不計算 Kin 數字，直接顯示 **Hunab Ku** 圖騰
- **範例**：2024/02/29 → 顯示 "Hunab Ku"

### 規則 2：閏年 3月1日之後
- **條件**：年份為閏年（如 2024, 2028），且日期在 3 月 1 日之後
- **處理**：計算出的 Kin 需要 **額外加 1**
- **原因**：修正跳過 2/29 的偏移

**閏年判斷邏輯**：
```javascript
function isLeapYear(year) {
    return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
}
```

---

## 📝 計算範例

### 範例 1：今天 (2026/01/06)

**步驟**：
1. 年份常數：`YEAR_CONSTANTS[2026] = 22`
2. 月份常數：`MONTH_CONSTANTS[1] = 0`
3. 日期：`6`
4. 計算：`22 + 0 + 6 = 28`
5. 2026 不是閏年，無需加 1

**結果**：
- **KIN 28**
- 圖騰編號：8
- 圖騰：黃星星（(28-1) mod 20 = 7，索引 7 = 第 8 個圖騰）
- 調性：月亮的（(28-1) mod 13 = 1，索引 1 = 第 2 個調性）
- **完整名稱：月亮的黃星星** ✅
- **圖片檔名：08.png**

### 範例 2：閏年日期 (2024/03/15)

**步驟**：
1. 年份常數：`YEAR_CONSTANTS[2024] = 72`
2. 月份常數：`MONTH_CONSTANTS[3] = 59`
3. 日期：`15`
4. 基本計算：`72 + 59 + 15 = 146`
5. 2024 是閏年，且 3/15 在 3 月 1 日之後，需 **+1**
6. 最終：`146 + 1 = 147`

**結果**：
- **KIN 147**
- 圖騰編號：7
- 圖騰：藍手（(147-1) mod 20 = 6，索引 6 = 第 7 個圖騰）
- 調性：光譜的（(147-1) mod 13 = 10，索引 10 = 第 11 個調性）
- **完整名稱：光譜的藍手**
- **圖片檔名：07.png**

### 範例 3：Hunab Ku 日 (2024/02/29)

**處理**：
- 檢測到 2 月 29 日
- 不進行 Kin 計算
- **直接顯示：Hunab Ku** 🌀

---

## 🎨 圖騰與調性對照

### 20 個圖騰（Solar Seals）

| 編號 | 圖騰名稱 | 編號 | 圖騰名稱 | 編號 | 圖騰名稱 | 編號 | 圖騰名稱 |
|------|----------|------|----------|------|----------|------|----------|
| 1    | 紅龍     | 6    | 白世界橋 | 11   | 藍猴     | 16   | 黃戰士   |
| 2    | 白風     | 7    | 藍手     | 12   | 黃人     | 17   | 紅地球   |
| 3    | 藍夜     | 8    | 黃星星   | 13   | 紅天行者 | 18   | 白鏡     |
| 4    | 黃種子   | 9    | 紅月     | 14   | 白巫師   | 19   | 藍風暴   |
| 5    | 紅蛇     | 10   | 白狗     | 15   | 藍鷹     | 20   | 黃太陽   |

### 13 個調性（Galactic Tones）

| 編號 | 調性名稱       | 編號 | 調性名稱       | 編號 | 調性名稱   |
|------|----------------|------|----------------|------|------------|
| 1    | 磁性的         | 6    | 韻律的         | 11   | 光譜的     |
| 2    | 月亮的         | 7    | 共振的         | 12   | 水晶的     |
| 3    | 電力的         | 8    | 銀河星系的     | 13   | 宇宙的     |
| 4    | 自我存在的     | 9    | 太陽的         |      |            |
| 5    | 超頻的         | 10   | 行星的         |      |            |

---

## 💻 代碼使用方式

### 方式 1：純 JavaScript（推薦用於靜態網站）

```html
<!-- 直接使用 cover.html -->
<!DOCTYPE html>
<html>
<head>
    <title>13月亮曆封面</title>
</head>
<body>
    <!-- 將 cover.html 的內容複製到這裡 -->
</body>
</html>
```

### 方式 2：React 組件

```jsx
import Cover from './Cover.jsx';

function App() {
    return <Cover />;
}
```

### 方式 3：獨立 JavaScript 模組

```javascript
// 引入計算器
const { calculateKin } = require('./kin-calculator.js');

// 計算今天
const now = new Date();
const result = calculateKin(
    now.getFullYear(),
    now.getMonth() + 1,
    now.getDate()
);

console.log(result);
// {
//   kin: 28,
//   sealNumber: 8,
//   seal: "黃星星",
//   tone: "月亮的",
//   displayText: "月亮的黃星星"
// }
// 圖片檔名：08.png
```

---

## 🖼️ 圖片資源需求

請確保以下圖片存在於 `./images/` 目錄：

- `hunab-ku-1.png` - Hunab Ku 圖騰
- `01.png` ~ `20.png` - 對應 20 個圖騰的圖片

### 圖騰編號對照表

| 編號 | 圖檔名 | 圖騰名稱 | 編號 | 圖檔名 | 圖騰名稱 |
|------|--------|----------|------|--------|----------|
| 1 | 01.png | 紅龍 | 11 | 11.png | 藍猴 |
| 2 | 02.png | 白風 | 12 | 12.png | 黃人 |
| 3 | 03.png | 藍夜 | 13 | 13.png | 紅天行者 |
| 4 | 04.png | 黃種子 | 14 | 14.png | 白巫師 |
| 5 | 05.png | 紅蛇 | 15 | 15.png | 藍鷹 |
| 6 | 06.png | 白世界橋 | 16 | 16.png | 黃戰士 |
| 7 | 07.png | 藍手 | 17 | 17.png | 紅地球 |
| 8 | 08.png | 黃星星 | 18 | 18.png | 白鏡 |
| 9 | 09.png | 紅月 | 19 | 19.png | 藍風暴 |
| 10 | 10.png | 白狗 | 20 | 20.png | 黃太陽 |

**注意**：
- KIN 編號是 1-260 循環
- 圖騰編號是 1-20 循環
- 圖片檔名使用圖騰編號，而非 KIN 編號
- 例如：KIN 28 = 圖騰 8 (黃星星) → 使用 `08.png`

---

## ✅ 驗證測試

### 測試案例

```javascript
// 測試 1: 今天 (2026/01/06)
calculateKin(2026, 1, 6);
// 預期: KIN 28, 月亮的黃星星 ✅

// 測試 2: 閏年後的日期 (2024/03/01)
calculateKin(2024, 3, 1);
// 預期: KIN 132 + 1 = KIN 133 ✅

// 測試 3: Hunab Ku (2024/02/29)
calculateKin(2024, 2, 29);
// 預期: isHunabKu = true ✅
```

---

## 🔧 疑難排解

### Q1: 顯示「年份數據未定義」
**解決方式**：需要在 `YEAR_CONSTANTS` 中添加該年份的常數值。

### Q2: 圖片無法載入
**解決方式**：
1. 檢查圖片路徑是否正確
2. 確認圖片命名格式為 `1.png` ~ `260.png`
3. 已自動設置備用圖片為 `hunab-ku-1.png`

### Q3: 閏年計算不正確
**檢查點**：
- 3 月 1 日及之後是否有加 1
- 閏年判斷邏輯是否正確
- 2 月 29 日是否正確顯示 Hunab Ku

---

## 📚 參考資料

- 基於 13 月亮曆官方講義數據
- Dreamspell (夢之咒語) 系統
- 馬雅曆法 Tzolkin 260 天週期

---

## 👨‍💻 維護資訊

**設計者**：KIN 74 太陽的白巫師 HIPER  
**版本**：1.0.0  
**最後更新**：2026.01.06

---

## 📞 聯絡方式

- Facebook: [hiper.wu](https://www.facebook.com/hiper.wu)
- Instagram: [@hiper.wu](https://www.instagram.com/hiper.wu)
- 波波的日常數數: [Facebook](https://www.facebook.com/profile.php?id=100074630472925)
